# 20230106

# 지금 당장 DevOps를 해야 하는 이유

> DevOps

- 데브옵스(DevOps)는 소프트웨어의 개발(Development)와 운영(Operations)의 합성어로서, 소프트웨어 개발자와 정보기술 전문가 간의 소통, 협업 및 통합을 강조하는 개발 환경이나 문화를 말한다.
- 데브옵스는 소프트웨어 개발조직과 운영조직간의 상호 의존적 대응이며 조직이 소프트웨어 제품과 서비스를 빠른 시간에 개발 및 배포하는 것을 목적으로 한다.

> 개발 프로세스 v1

- 코드 작성한 것을 압축하여 Server에 파일을 올려서 실행한다.

> 개발 프로세스 v2

- 로컬에서 코드를 작성하고 Git에 push 하면 git 에서 다운로드 받아서 실행한다.

> 개발 프로세스 v3

- CI/CD라는 자동화 프로그램을 사용해서, source를 자동으로 다운 받아 빌드 후 배포까지 자동으로 이루어진다.

> 개발 프로세스 v4

- CI는 빌드에 특화, CD는 배포에 특화 되어있다.
- CI/CD가 통합되어 있으면 소스를 수정하고 push하면 바로 배포되는 단점이 있었다.
- 빌드 따로 배포 따로

> 개발 프로세스 v5

- 배포를 하게 된다면 불특정 다수가 몰려 서버가 다운 되는 경우가 발생할 수도 있다.
- 마지막 모니터링 단계가 중요해진다.

> 개발과 배포는 생각보다 복잡하다.

- 개발 팀의 규모에 따라 다르고, 서비스의 복잡도에 따라 다르다.

> DevOps 하면 떠오르는 도커 / 쿠버네티스를 도입하면 더 빨라지나?

- 결론적으로 좋은 도구보다는 서비스와 관련하여 필요한 기술을 도입하여야 한다.
- DevOps = 철학 & 방법론 -> 문화
- 우리팀이 자연스럽게 신경쓰는 것

> DevOps의 방법

- 작은 것부터 시작하자!

  - Git - DevOps에서 중요한 역할
  - Docker, Kubernetes

> 결론적으로

- DevOps란 철학이자 방법론이면서 문화이다
- 좋은 도구를 잘 사용해서 자동화

  - 시간 절약 -> 호율 증가

- 좋은 도구를 잘 사용해서 측정

  - 빠른 분석 -> 효율 증가

- 좋은 도구를 잘 사용해서 공유

  - 팀원 지식 습득 -> 효율 증가

- 좋은 도구를 잘 사용해서 축적

  - 패시브 스킬 -> 효율 증가

- 현재 많은 사람들이 사용하는 좋은 도구의 예

  - git, docker, kubernetes

> docker, kubernetes를 배우는 이유

- 새로운 기술을 배우는 이유는 개발과 배포를 개선하기 위함
- 새로운 도구를 도입했는데 개발과 배포가 개선되지 않는다면 재검토
- 도입하는게 좋을지 안좋을지 알아보자

# 01. 서버를 관리한다는 것

> 서버 관리 

1. 자체 서버 운영
2. 설정 관리 도구 등장
3. 가상 머신 등장
4. 클라우드 등장
5. PaaS 등장
6. 도커 등장
7. 쿠버네티스 등장
8. 서비스메시 등장

> 1. 자체 서버 운영

- 서버 주문 > 서버 설치 > CPU, 메모리, HDD > 네트워크 연결 > OS 설치 > 계정 설정 > 방화벽 설정 > ...
- 서버를 설정하기 위해 많은 노력, 시간이 필요
- 성능이 좋은 걸 미리 구매하고 효율적인 사용을 위해 여러 애플리케이션을 설치

> 2. 설정 관리 도구

- 상태 관리 도구 등장

> 3. 가상 머신

> 4. 클라우드

- AWS, Google Cloud, Azure, ...
- 하드웨어 파편화 문제 해결
- 가상화된 환경만으로 아키텍처 구성이 가능해짐
- 이미지를 기반으로 한 다수의 서버 상태 관리

  - 상태 관리에 대한 새로운 접근
  - 서버 운영의 문제는 여전히 그대로 남아 있음

- 마치 전기를 사용하듯 편리

> 5. PasS

- Vercel, Heroku, Netlify, AWS Elastic Beanstalk, Google Cloud App Engine, ...
- 서버를 운영하는 것은 복잡하고 어렵다
- 잘 구성해 놓은 곳에 소스 코드만으로 배포
- 일반화된 프로비저닝 방법을 제공

  - 프로비저닝 과정에 개입할 수 없음
  - ex. Heroku의 buildpacks

- PasS는 서버 운영의 은총알?

- PasS 단점

  - 애플리케이션을 PasS 방식에 맞게 작성해야 함
  - 서버에 대한 원격 접속 시스템을 제공하지 않음
  - 서버에 파일 시스템을 사용할 수 없음
  - 서버 패키지를 설치할 수 없음
  - 로그 수집을 제한적인 방식으로 허용(STDOUT)
  - 애플리케이션 배포에 대한 새로운 패러다임

- PasS에서 할 수 있을까?

  - 크론잡(문자 발송, 예약, 정산 등)
  - 데이터 분석(BigQuery, S3 등 연동)
  - 로그 분석(엘라스틱 서치, 스택드라이버, 클라우드와치 등)
  - 애플리케이션 성능 모니터링
  - A/B 테스트, Canary 배포
  - 네트워크, 스토리지 설정

# 02. 도커와 쿠버네티스의 등장

- 도커가 등장하고 서버관리 / 개발 방식이 완전히 바뀌게 됨

- 실행을 위한 파일들이 들어있고 실행 명령만 내리면 자동으로 실행

- 어떠한 프로그램도 컨테이너로 만들 수 있고, 어디서든 돌아간다.

> 도커의 특징

- 가상머신처럼 독립적으로 실행되지만
- 가상머신보다 빠르고
- 가상머신보다 쉽고
- 가상머신보다 효율적이다.

- 자원의 격리

  - 프로그램을 띄울 때 다른 프로그램을 띄울 수 없는 기능

- 프로세스를 가상으로 분리, 파일 디렉토리 가상으로 분리
- CPU, Memory, I/O > 그룹별로 제한
- 리눅스 기능을 이용한 빠르고 효율적인 서버 관리

> 도커의 등장

- 2013년에 DotCloud(현 Docker)에서 첫 공개 컨테이너 : 격리된 환경에서 작동하는 프로세스 리눅스 커널의 여러 기술을 활용, 하드웨어 가상화 기술보다 가벼움, 이미지 단위로 프로세스 실행 환경을 구성

> VM(가상머신) vs Docker

- 가상머신

  - OS 위에 OS -> 무거움

- Docker

  - 같은 OS 안에 격리 -> A는 A대로, B는 B대로

> 도커가 가져온 변화

- 클라우드 이미지보다관리하기 쉬움
- 다른 프로세스와 격리되어 가상머신처럼 사용하지만 성능저하 거의 없음
- 복잡한 기술(namespace, cgroups, network, ...)을 몰라도 사용할 수 있음
- 이미지 빌드 기록이 남음
- 코드와 설정으로 관리 -> 재현 및 수정 가능
- 오픈소스 -> 특정 회사 기술에 종속적이지 않음

> 도커 그 이후

- 컨테이너가 많아지고 앱이 많아지면 관리가 귀찮아짐
- 그럴 땐 어떻게 해야할까?

1. 배포는 어떻게 할까?

- 서버들을 하나하나 관리하기 어렵다.
- 서버가 많을 경우 롤아웃/롤백에 손이 많이 간다.

2. 서비스 검색은 어떻게 할까?

- 서버가 두 개일 경우 LoadBalancer를 이용하여 하나하나 적용해야 한다.

3. 서비스 노출은 어떻게 할까?

- 한 서버에 도메인이 여러 개이면 따로따로 띄워줘야 하는데 자동으로 설정하고싶다.

4. 서비스 이상, 부하 모니터링은 어떻게 할까?

- 서버에 문제가 생겼을 경우 모니터링 해야한다.

> 컨테이너 오케스트레이션

- 복잡한 컨테이너 환경을 효과적으로 관리하기 위한 도구

- 기능

1. Cluster

   - 중앙 제어
   - 네트워킹
   - 노드 스케일

2. State

   - 상태 관리

3. Scheduling

   - 배포 관리

4. Rollout & Rollback

   - 배포 버전 관리

5. Service Discovery

   - 서비스 등록 및 조회

6. Volume

   - 볼륨 스토리지

- 컨테이너 관리도구 춘추전국시대가 일어남

> kubernetes

- 컨테이너를 쉽고 빠르게 배포/확장하고 관리를 자동화해주는 오픈소스 플랫폼

- 1주일에 20억개의 컨테이너를 생성하는 google이 컨테이너 배포 시스템으로 사용하던 borg를 기반으로 만든 오픈소스

> 특징

- 운영에서 사용 가능한 컨테이너 오케스트레이션
- 행성 스케일(구글보다 적게 사용하면 OK)
- 어디서나 동작

> 왜 쿠버네티스 인가?

1. 오픈소스

   - Google, Red Hat, Huawai, VMware, Microsoft, IBM 등등
   - 전세계 모임

2. 엄청난 인기
3. 무한한 확장성

   - 머신러닝, CI/CD, 서비스메시, 서버리스 등

4. 사실상의 표준(de facto)

- 데 팍토는 사실상의 의미로 쓰이는 표현으로, 너무 많은 사람이 써서 사실상 표준으로 사용하고 있는 것
- 도커도 쿠버네티스 지원

> CNCF

- Cloud Native Computing Foundation
- 클라우드 환경에 적합한 컴퓨팅 기술을 지원

# 3. 배포 프로세스 개선하기

pass

# 4. DevOps 엔지니어

- 아마존 : 11.7초마다 배포
- 페이스북 : 일주일 마다 배포
- 넷플릭스 : 하루에 여러번

> DevOps의 역할

- 조직이 소프트웨어 제품과 서비스를 빠른 시간에 개발 및 배포하는 것

- 서비스 배포,지원 + 모니터링
- 배포 파이프라인 구성
- 더 자주 더 빠른 릴리스
- Cloud / Cloud Native
- 컨테이너(Docker, Kubernetes, ...)
- 보안 Network, IAM, Service Mesh, ...
- 장애 대응
- IaC - 테라폼, ...
- SRE - SLI, SLO, ...
- 외부 서비스 - DataDog, NewRelic, ...

> DevOps 로드맵

https://roadmap.sh/devops

> 10주 DevOps 스터디

1. Terraform을 이용하여 AWS VPC 만들기
2. 도커(컨테이너)로 서버 관리하기
3. 자동 빌드 & 자동 배포(CI/CD)
4. 배포 알림 / 채팅 봇 만들기
5. 쿠버네티스와 함께하는 컨테이너 오케스트레이션
6. AWS EKS 본격 설정
7. 모니터링
8. 로그 수집
9. 배포 최적화
10. 서비스메시(+보안)

> 취업

- 어떤 신입을 원하는가?

  - 완벽하게 준비된 사람 (X)
  - 문제를 해결할 수 있는(것 같은) 사람

> 왜

- 왜 지금 이걸 하고 있는지
- 이 프로젝트의 목적은 무엇인지
- 이 프로젝트가 기존에 있던 것보다 나은 점은 무엇인지

